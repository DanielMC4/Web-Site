<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Web-Site</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

<style>
/* =========================
   ROOT + RESET
========================= */
:root{
  --bg:#0b0c10;
  --panel:rgba(20,22,30,.88);
  --card:rgba(28,30,40,.9);
  --teal:#00ffd5;
  --orange:#ff7a00;
  --danger:#ff4b4b;
}
*{box-sizing:border-box;font-family:system-ui,Segoe UI}
body{
  margin:0;
  background:radial-gradient(circle at top,#1a1c22,#000);
  color:white;
  display:flex;
  height:100vh;
  overflow:hidden;
}

/* =========================
   SPIDER WEB BACKGROUND
========================= */
canvas{
  position:fixed;
  inset:0;
  z-index:-1;
}

/* =========================
   PANEL
========================= */
#panel{
  width:270px;
  background:var(--panel);
  backdrop-filter:blur(16px);
  padding:18px;
  display:flex;
  flex-direction:column;
  gap:12px;
  border-right:1px solid #222;
}
#panel h1{
  text-align:center;
  color:var(--teal);
  text-shadow:0 0 20px var(--teal);
}
#panel small{
  text-align:center;
  opacity:.7;
}
button,input,select{
  padding:12px;
  border:none;
  border-radius:10px;
}
button{
  background:linear-gradient(135deg,var(--teal),var(--orange));
  font-weight:700;
  cursor:pointer;
}
button.danger{
  background:linear-gradient(135deg,var(--danger),#ff0000);
}
input,select{
  background:#111;
  color:white;
}

/* =========================
   MAIN GRID
========================= */
#main{
  flex:1;
  padding:28px;
  display:grid;
  grid-template-columns:repeat(auto-fill,280px);
  gap:26px;
  overflow:auto;
}

/* =========================
   CARD
========================= */
.card{
  background:var(--card);
  border-radius:18px;
  overflow:hidden;
  box-shadow:0 0 30px rgba(0,255,213,.25);
  cursor:pointer;
  transition:.4s;
}
.card:hover{
  transform:scale(1.06);
  box-shadow:0 0 45px rgba(255,122,0,.45);
}
.card img{
  width:100%;
  height:160px;
  object-fit:cover;
  background:#000;
}
.card h3{
  margin:8px 0 2px;
  text-align:center;
}
.card small{
  display:block;
  text-align:center;
  opacity:.7;
  padding-bottom:6px;
}
.controls{
  display:flex;
  gap:8px;
  padding:8px;
}
.controls button{
  flex:1;
  padding:8px;
  font-size:12px;
}

/* =========================
   VIEWER
========================= */
#viewer{
  position:fixed;
  inset:0;
  background:#000;
  display:none;
  flex-direction:column;
  z-index:999;
}
#viewerHeader{
  display:flex;
  gap:10px;
  padding:10px;
}
#viewer iframe{
  flex:1;
  border:none;
}

/* =========================
   LOGIN
========================= */
#login{
  position:fixed;
  inset:0;
  background:#000;
  display:flex;
  align-items:center;
  justify-content:center;
  flex-direction:column;
  gap:12px;
  z-index:1000;
}
</style>
</head>

<body>

<canvas id="web"></canvas>

<div id="login">
  <h2>Web-Site Login</h2>
  <input id="email" placeholder="Email">
  <input id="password" placeholder="Password" type="password">
  <button onclick="login()">Login / Sign Up</button>
</div>

<div id="panel" hidden>
  <h1>Web-Site</h1>
  <small id="roleLabel"></small>
  <input id="search" placeholder="Search sites">
  <select id="categoryFilter">
    <option value="all">All Categories</option>
  </select>
  <button onclick="addSite()">âž• Add Site</button>
  <button class="danger" onclick="logout()">Logout</button>
</div>

<div id="main"></div>

<div id="viewer">
  <div id="viewerHeader">
    <input id="viewerPass" placeholder="Viewer Password">
    <button onclick="unlockViewer()">Unlock</button>
    <button class="danger" onclick="closeViewer()">Close</button>
  </div>
  <iframe></iframe>
</div>

<script>
/* =========================
   FIREBASE INIT
========================= */
firebase.initializeApp({
  /* PASTE YOUR FIREBASE CONFIG HERE */
});
const auth=firebase.auth();
const db=firebase.firestore();

/* =========================
   CONSTANTS
========================= */
const ADMINS=["ELIADMIN1","DANIELADMIN2"];
const main=document.getElementById("main");
const panel=document.getElementById("panel");
const loginBox=document.getElementById("login");
const categoryFilter=document.getElementById("categoryFilter");
let currentSite=null;
let isAdmin=false;

/* =========================
   AUTH
========================= */
function login(){
 auth.signInWithEmailAndPassword(email.value,password.value)
 .catch(()=>auth.createUserWithEmailAndPassword(email.value,password.value));
}
function logout(){auth.signOut()}

auth.onAuthStateChanged(user=>{
 if(!user){
  loginBox.style.display="flex";
  panel.hidden=true;
 }else{
  loginBox.style.display="none";
  panel.hidden=false;
  const name=user.email.split("@")[0].toUpperCase();
  isAdmin=ADMINS.includes(name);
  roleLabel.textContent=isAdmin?"Admin":"Viewer";
  loadSites();
 }
});

/* =========================
   LOAD & RENDER
========================= */
function loadSites(){
 db.collection("sites").onSnapshot(snap=>{
  main.innerHTML="";
  categoryFilter.innerHTML='<option value="all">All Categories</option>';
  let cats=new Set();

  snap.forEach(doc=>{
   const site=doc.data();
   site.id=doc.id;
   cats.add(site.category);

   if(categoryFilter.value!=="all" && site.category!==categoryFilter.value)return;
   if(!site.name.toLowerCase().includes(search.value.toLowerCase()))return;

   const card=document.createElement("div");
   card.className="card";
   card.innerHTML=`
    <img src="https://www.google.com/s2/favicons?sz=256&domain=${site.url}">
    <h3>${site.name}</h3>
    <small>${site.category}</small>
   `;
   card.onclick=()=>openViewer(site);

   if(isAdmin){
    const controls=document.createElement("div");
    controls.className="controls";
    controls.innerHTML=`
      <button>Edit</button>
      <button class="danger">Delete</button>
    `;
    controls.children[0].onclick=e=>{
      e.stopPropagation();
      editSite(site);
    };
    controls.children[1].onclick=e=>{
      e.stopPropagation();
      deleteSite(site.id);
    };
    card.appendChild(controls);
   }
   main.appendChild(card);
  });

  cats.forEach(c=>{
   const o=document.createElement("option");
   o.value=o.textContent=c;
   categoryFilter.appendChild(o);
  });
 });
}

search.oninput=loadSites;
categoryFilter.onchange=loadSites;

/* =========================
   ADMIN ACTIONS
========================= */
function addSite(){
 if(!isAdmin)return alert("Admins only");
 const name=prompt("Site name");
 const url=prompt("Site URL");
 const category=prompt("Category");
 const pass=prompt("Viewer password");
 if(name&&url&&category&&pass)
  db.collection("sites").add({name,url,category,pass});
}
function editSite(site){
 const name=prompt("Name",site.name);
 const url=prompt("URL",site.url);
 const category=prompt("Category",site.category);
 const pass=prompt("Viewer password",site.pass);
 db.collection("sites").doc(site.id).update({name,url,category,pass});
}
function deleteSite(id){
 if(confirm("Delete this site?"))
  db.collection("sites").doc(id).delete();
}

/* =========================
   VIEWER
========================= */
function openViewer(site){
 currentSite=site;
 viewer.style.display="flex";
 viewer.querySelector("iframe").src="";
}
function unlockViewer(){
 if(viewerPass.value!==currentSite.pass)return alert("Wrong password");
 viewer.querySelector("iframe").src=currentSite.url;
}
function closeViewer(){
 viewer.style.display="none";
 viewer.querySelector("iframe").src="";
}

/* =========================
   SPIDER WEB ANIMATION
========================= */
const c=document.getElementById("web");
const ctx=c.getContext("2d");
function resize(){c.width=innerWidth;c.height=innerHeight}
window.onresize=resize;resize();
let pts=[...Array(90)].map(()=>({
 x:Math.random()*c.width,
 y:Math.random()*c.height,
 vx:(Math.random()-.5)*.5,
 vy:(Math.random()-.5)*.5
}));
(function animate(){
 ctx.clearRect(0,0,c.width,c.height);
 pts.forEach(p=>{
  p.x+=p.vx;p.y+=p.vy;
  if(p.x<0||p.x>c.width)p.vx*=-1;
  if(p.y<0||p.y>c.height)p.vy*=-1;
  pts.forEach(o=>{
   const d=Math.hypot(p.x-o.x,p.y-o.y);
   if(d<120){
    ctx.strokeStyle=`rgba(0,255,213,${1-d/120})`;
    ctx.beginPath();
    ctx.moveTo(p.x,p.y);
    ctx.lineTo(o.x,o.y);
    ctx.stroke();
   }
  });
 });
 requestAnimationFrame(animate);
})();
</script>

</body>
</html>
